<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Restablecer contraseña</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    :root{
      --bg:#0B2147;
      --card:#143b71cf;
      --accent:#ffcc33;
      --text-dark:#082a65;
      --white:#ffffff;
    }

    html,body{
      height:100%;
      margin:0;
      font-family:"Verdana", Geneva, Tahoma, sans-serif;
      background:var(--bg);
      color:#fff;
      overflow:hidden;
    }

    .page-wrap{
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:1rem;
    }

    .card-reset{
      width:100%;
      max-width:430px;
      background:var(--card);
      border-radius:22px;
      padding:1.4rem 1.4rem 2rem 1.4rem;
      box-shadow:0 8px 30px rgba(0,0,0,0.45);
      animation:slideIn .6s ease;
      height:75vh; /* MÁS PEQUEÑA */
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
      gap:0.4rem;
      overflow:hidden;
    }

    @keyframes slideIn{
      from{opacity:0; transform:translateY(20px)}
      to{opacity:1; transform:translateY(0)}
    }

    .back-btn {
      background: var(--accent);
      border: none;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 6px 18px rgba(254, 209, 48, 0.45);
      cursor: pointer;
      transition: transform .2s ease, box-shadow .2s ease;
    }
    .back-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 24px rgba(254, 209, 48, 0.55);
    }
    .back-btn img {
      width:20px;
      height:20px;
    }

    h3{
      text-align:center;
      margin:1rem 0 1.2rem 0;
      font-weight:700;
    }

    label{
      font-weight:600;
      margin-left:.3rem;
    }

    .form-control{
      height:45px;
      border-radius:14px;
      background:#fbfdff;
      border:none;
      font-size:.95rem;
      margin-bottom:1rem;
      text-align:center;
    }

    .btn-reset{
      background:var(--accent);
      color:var(--text-dark);
      font-weight:700;
      border-radius:14px;
      width:100%;
      padding:.75rem;
      box-shadow:0 0 18px rgba(255,204,51,0.55);
      border:0;
      transition:transform .15s ease;
    }
    .btn-reset:hover{
      transform:translateY(-3px);
    }
    
    .swal2-popup{
      border-radius:20px!important;
      background-color:#143b71!important;
      color:#fff!important;
      width:320px!important;
      padding:1.5rem!important;
      text-align:center!important;
      box-shadow:0 0 28px rgba(254,209,48,0.4);
    }

    .swal2-title{
      font-size:1.3rem!important;
      font-weight:700!important;
    }

    .swal2-html-container{
      font-size:1rem!important;
    }

    .swal2-confirm{
      background-color:#fed130!important;
      color:#082a65!important;
      border-radius:12px!important;
      font-weight:700!important;
      padding:.5rem 1.5rem!important;
    }

  </style>
</head>
<body>

<div class="page-wrap">
  <div class="card-reset">

    <button class="back-btn" onclick="location.href='{{ url_for('login_page') }}'">
      <img src="https://cdn-icons-png.flaticon.com/512/271/271220.png">
    </button>

    <h3>Cambiar contraseña</h3>

    <label>Nueva contraseña</label>
    <input type="password" id="pass1" class="form-control" placeholder="Ingresa tu nueva contraseña" required>

    <label>Confirmar contraseña</label>
    <input type="password" id="pass2" class="form-control" placeholder="Repite la contraseña" required>

    <button class="btn-reset" onclick="guardarNuevaContrasena()">Guardar</button>

  </div>
</div>

<script>
function guardarNuevaContrasena(){
  const p1 = pass1.value.trim();
  const p2 = pass2.value.trim();

  if(!p1 || !p2){
    return Swal.fire({
      icon:"warning",
      title:"Campos incompletos",
      text:"Debes llenar ambos campos.",
    });
  }
  if(p1.length < 4){
    return Swal.fire({
      icon:"error",
      title:"Contraseña muy corta",
      text:"Debe tener mínimo 4 caracteres.",
    });
  }
  if(p1 !== p2){
    return Swal.fire({
      icon:"error",
      title:"No coinciden",
      text:"Las contraseñas deben ser iguales.",
    });
  }

  Swal.fire({
    icon:"success",
    title:"¡Actualizada!",
    text:"Tu contraseña ha sido cambiada.",
  }).then(()=> location.href="{{ url_for('login_page') }}");
}
</script>

</body>
</html>
